<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.text.*?>
<?import javafx.geometry.*?>
<?import javafx.scene.chart.BarChart?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.NumberAxis?>

<BorderPane xmlns:fx="http://javafx.com/fxml" fx:controller="Controllers.Back.StatistiquesController"
           stylesheets="/styles/theme.css"
           minWidth="900" minHeight="600" prefHeight="800.0" prefWidth="1200.0">

    <!-- En-tête -->
    <top>
        <HBox styleClass="header" alignment="CENTER_LEFT" spacing="20">
            <padding>
                <Insets top="15" right="30" bottom="15" left="30"/>
            </padding>
            <Text text="Statistiques des Réclamations" styleClass="header-title"/>
            <Region HBox.hgrow="ALWAYS" />
            <Label text="Admin Dashboard" styleClass="header-subtitle"/>
        </HBox>
    </top>

    <!-- Barre latérale -->
    <left>
        <VBox styleClass="admin-sidebar">
            <padding>
                <Insets top="20" right="15" bottom="20" left="15"/>
            </padding>
            
            <Label text="Menu Principal" styleClass="sidebar-title"/>
            
            <VBox styleClass="menu-items" spacing="15">
                <Button text="Tableau de bord" onAction="#handleDashboard" styleClass="menu-item"/>
                <Button text="Réclamations" onAction="#handleReclamations" styleClass="menu-item"/>
                <Button text="Réponses" onAction="#handleReponses" styleClass="menu-item"/>
                <Button text="Messagerie" onAction="#handlMessagerie" styleClass="menu-item"/>
                <Button text="Statistiques" styleClass="menu-item, menu-item-active"/>
            </VBox>
            
            <Region VBox.vgrow="ALWAYS"/>
            
            <Button text="Déconnexion" onAction="#handleRetourHome" styleClass="menu-item, menu-item-logout"/>
        </VBox>
    </left>

    <!-- Contenu principal -->
    <center>
        <ScrollPane fitToWidth="true" styleClass="main-scroll">
            <VBox spacing="25">
                <padding>
                    <Insets top="30" right="40" bottom="30" left="40"/>
                </padding>

                <!-- Section des statistiques -->
                <HBox spacing="20" styleClass="stats-container">
                    <VBox styleClass="stat-card" HBox.hgrow="ALWAYS">
                        <Label text="Total Réclamations" styleClass="stat-label"/>
                        <Label fx:id="totalValue" text="0" styleClass="stat-value"/>
                    </VBox>
                    <VBox styleClass="stat-card" HBox.hgrow="ALWAYS">
                        <Label text="En Attente" styleClass="stat-label"/>
                        <Label fx:id="enAttenteValue" text="0" styleClass="stat-value"/>
                    </VBox>
                    <VBox styleClass="stat-card" HBox.hgrow="ALWAYS">
                        <Label text="En Cours" styleClass="stat-label"/>
                        <Label fx:id="enCoursValue" text="0" styleClass="stat-value"/>
                    </VBox>
                    <VBox styleClass="stat-card" HBox.hgrow="ALWAYS">
                        <Label text="Traitées" styleClass="stat-label"/>
                        <Label fx:id="traiteesValue" text="0" styleClass="stat-value"/>
                    </VBox>
                </HBox>

                <!-- Graphiques des statistiques -->
                <GridPane hgap="20" vgap="20">
                    <columnConstraints>
                        <ColumnConstraints percentWidth="100"/>
                    </columnConstraints>
                    
                    <!-- Graphique circulaire -->
                    <VBox styleClass="content-section" GridPane.columnIndex="0" GridPane.rowIndex="0">
                        <padding>
                            <Insets top="20" right="20" bottom="20" left="20"/>
                        </padding>
                        <HBox alignment="CENTER_LEFT" spacing="20">
    <Label fx:id="pieChartTitle" text="Répartition des Statuts" styleClass="section-title"/>
    <RadioButton fx:id="statRadio" text="Par Statut" selected="true" onAction="#updatePieChart"/>
<RadioButton fx:id="userRadio" text="Par Utilisateur" onAction="#updatePieChart"/>
                        </HBox>
                        <PieChart fx:id="statutPieChart" minHeight="350"/>
                        
                    </VBox>
                    
                    <!-- Tableau détaillé -->
                    <VBox styleClass="content-section" GridPane.columnIndex="0" GridPane.rowIndex="1">
                        <padding>
                            <Insets top="20" right="20" bottom="20" left="20"/>
                        </padding>
                        <Label text="Statistiques Détaillées" styleClass="section-title"/>
                        <TableView fx:id="statsTableView" VBox.vgrow="ALWAYS" minHeight="300">
                            <columnResizePolicy>
                                <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                            </columnResizePolicy>
                            <columns>
                                <TableColumn fx:id="periodeColumn" text="Période" minWidth="200"/>
                                <TableColumn fx:id="totalColumn" text="Total" minWidth="150"/>
                                <TableColumn fx:id="attenteColumn" text="En Attente" minWidth="150"/>
                                <TableColumn fx:id="coursColumn" text="En Cours" minWidth="150"/>
                                <TableColumn fx:id="traiteesColumn" text="Traitées" minWidth="150"/>
                            </columns>
                            <VBox.margin>
                                <Insets top="10"/>
                            </VBox.margin>
                        </TableView>
                    </VBox>
                </GridPane>


            </VBox>
        </ScrollPane>
    </center>
</BorderPane> 